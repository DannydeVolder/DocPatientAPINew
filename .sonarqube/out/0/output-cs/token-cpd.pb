™!
UC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Contexts\AppDbContext.cs
	namespace 	
DataAccessLayer
 
. 
Contexts "
{ 
public 

class 
AppDbContext 
: 
IdentityDbContext  1
<1 2
User2 6
,6 7
ApplicationRole8 G
,G H
GuidI M
>M N
{ 
public 
AppDbContext 
( 
DbContextOptions ,
<, -
AppDbContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{ 	
} 	
public 
DbSet 
< 
Patient 
> 
Patients &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Doctor 
> 
Doctors $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
MedicalFile  
>  !
MedicalFiles" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Medicine 
> 
Medicine '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public!! 
DbSet!! 
<!! 
	Diagnosis!! 
>!! 
	Diagnosis!!  )
{!!* +
get!!, /
;!!/ 0
set!!1 4
;!!4 5
}!!6 7
public## 
DbSet## 
<## 
Appointment##  
>##  !
Appointments##" .
{##/ 0
get##1 4
;##4 5
set##6 9
;##9 :
}##; <
	protected%% 
override%% 
void%% 
OnModelCreating%%  /
(%%/ 0
ModelBuilder%%0 <
builder%%= D
)%%D E
{&& 	
base(( 
.(( 
OnModelCreating((  
(((  !
builder((! (
)((( )
;(() *
builder++ 
.++ 
Entity++ 
<++ 
Doctor++ !
>++! "
(++" #
)++# $
.,, 
HasMany,, 
(,, 
p,, 
=>,, 
p,, 
.,,  
Patients,,  (
),,( )
.-- 
WithOne-- 
(-- 
p-- 
=>-- 
p-- 
.--  
Doctor--  &
)--& '
... 
HasForeignKey.. 
(.. 
p..  
=>..! #
p..$ %
...% &
DoctorId..& .
)... /
.// 
OnDelete// 
(// 
DeleteBehavior// (
.//( )
Restrict//) 1
)//1 2
;//2 3
builder33 
.33 
Entity33 
<33 
User33 
>33  
(33  !
)33! "
.33" #
ToTable33# *
(33* +
$str33+ 2
)332 3
;333 4
builder44 
.44 
Entity44 
<44 
MedicalFile44 &
>44& '
(44' (
)44( )
.44) *
ToTable44* 1
(441 2
$str442 @
)44@ A
;44A B
builder55 
.55 
Entity55 
<55 
Medicine55 #
>55# $
(55$ %
)55% &
.55& '
ToTable55' .
(55. /
$str55/ 9
)559 :
;55: ;
builder66 
.66 
Entity66 
<66 
	Diagnosis66 $
>66$ %
(66% &
)66& '
.66' (
ToTable66( /
(66/ 0
$str660 ;
)66; <
;66< =
builder77 
.77 
Entity77 
<77 
Appointment77 &
>77& '
(77' (
)77( )
.77) *
ToTable77* 1
(771 2
$str772 @
)77@ A
;77A B
}>> 	
}?? 
}@@ Ö#
fC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Migrations\20201123132645_Appointments.cs
	namespace 	
DataAccessLayer
 
. 

Migrations $
{ 
public 

partial 
class 
Appointments %
:& '
	Migration( 1
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str $
,$ %
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
AppointmentName #
=$ %
table& +
.+ ,
Column, 2
<2 3
string3 9
>9 :
(: ;
nullable; C
:C D
trueE I
)I J
,J K
DateAndTime 
=  !
table" '
.' (
Column( .
<. /
DateTime/ 7
>7 8
(8 9
nullable9 A
:A B
falseC H
)H I
,I J
	PatientId 
= 
table  %
.% &
Column& ,
<, -
Guid- 1
>1 2
(2 3
nullable3 ;
:; <
true= A
)A B
,B C
DoctorId 
= 
table $
.$ %
Column% +
<+ ,
Guid, 0
>0 1
(1 2
nullable2 :
:: ;
true< @
)@ A
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 6
,6 7
x8 9
=>: <
x= >
.> ?
Id? A
)A B
;B C
table 
. 

ForeignKey $
($ %
name 
: 
$str >
,> ?
column 
: 
x  !
=>" $
x% &
.& '
DoctorId' /
,/ 0
principalTable &
:& '
$str( /
,/ 0
principalColumn '
:' (
$str) -
,- .
onDelete  
:  !
ReferentialAction" 3
.3 4
Restrict4 <
)< =
;= >
table 
. 

ForeignKey $
($ %
name 
: 
$str ?
,? @
column 
: 
x  !
=>" $
x% &
.& '
	PatientId' 0
,0 1
principalTable   &
:  & '
$str  ( /
,  / 0
principalColumn!! '
:!!' (
$str!!) -
,!!- .
onDelete""  
:""  !
ReferentialAction""" 3
.""3 4
Restrict""4 <
)""< =
;""= >
}## 
)## 
;## 
migrationBuilder%% 
.%% 
CreateIndex%% (
(%%( )
name&& 
:&& 
$str&& 0
,&&0 1
table'' 
:'' 
$str'' %
,''% &
column(( 
:(( 
$str(( "
)((" #
;((# $
migrationBuilder** 
.** 
CreateIndex** (
(**( )
name++ 
:++ 
$str++ 1
,++1 2
table,, 
:,, 
$str,, %
,,,% &
column-- 
:-- 
$str-- #
)--# $
;--$ %
}.. 	
	protected00 
override00 
void00 
Down00  $
(00$ %
MigrationBuilder00% 5
migrationBuilder006 F
)00F G
{11 	
migrationBuilder22 
.22 
	DropTable22 &
(22& '
name33 
:33 
$str33 $
)33$ %
;33% &
}44 	
}55 
}66 
gC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Migrations\20201123215630_Appointments2.cs
	namespace 	
DataAccessLayer
 
. 

Migrations $
{ 
public 

partial 
class 
Appointments2 &
:' (
	Migration) 2
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 

DropColumn

 '
(

' (
name 
: 
$str #
,# $
table 
: 
$str %
)% &
;& '
migrationBuilder 
. 
	AddColumn &
<& '
DateTime' /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str %
,% &
nullable 
: 
false 
,  
defaultValue 
: 
new !
DateTime" *
(* +
$num+ ,
,, -
$num. /
,/ 0
$num1 2
,2 3
$num4 5
,5 6
$num7 8
,8 9
$num: ;
,; <
$num= >
,> ?
DateTimeKind@ L
.L M
UnspecifiedM X
)X Y
)Y Z
;Z [
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str 
, 
table 
: 
$str %
,% &
nullable 
: 
true 
) 
;  
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str 
, 
table 
: 
$str %
)% &
;& '
migrationBuilder   
.   

DropColumn   '
(  ' (
name!! 
:!! 
$str!! 
,!! 
table"" 
:"" 
$str"" %
)""% &
;""& '
migrationBuilder$$ 
.$$ 
	AddColumn$$ &
<$$& '
DateTime$$' /
>$$/ 0
($$0 1
name%% 
:%% 
$str%% #
,%%# $
table&& 
:&& 
$str&& %
,&&% &
type'' 
:'' 
$str'' !
,''! "
nullable(( 
:(( 
false(( 
,((  
defaultValue)) 
:)) 
new)) !
DateTime))" *
())* +
$num))+ ,
,)), -
$num)). /
,))/ 0
$num))1 2
,))2 3
$num))4 5
,))5 6
$num))7 8
,))8 9
$num)): ;
,)); <
$num))= >
,))> ?
DateTimeKind))@ L
.))L M
Unspecified))M X
)))X Y
)))Y Z
;))Z [
}** 	
}++ 
},, Å
VC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\ApplicationRole.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
ApplicationRole  
:! "
IdentityRole# /
</ 0
Guid0 4
>4 5
{		 
public 
ApplicationRole 
( 
string %
name& *
)* +
{ 	
Name 
= 
name 
; 
} 	
public 
override 
Guid 
Id 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} Á
RC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\Appointment.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
Appointment 
: 
IEntity &
<& '
Guid' +
>+ ,
{ 
public		 
Guid		 
Id		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
public 
string 
AppointmentName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
Date 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Time 
{ 
get  
;  !
set" %
;% &
}' (
public 
Patient 
Patient 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
Guid 
? 
	PatientId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
Doctor 
Doctor 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Guid 
? 
DoctorId 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ¸
PC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\Diagnosis.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
	Diagnosis 
: 
IEntity $
<$ %
Guid% )
>) *
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 
string 
DiagnosisName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string  
DiagnosisInformation *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
Guid 
? 
MedicalFileID "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ò
MC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\Doctor.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
Doctor 
: 
User 
{		 
public 
IList 
< 
Patient 
> 
Patients &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Patient@ G
>G H
(H I
)I J
;J K
} 
} €
NC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\IEntity.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

	interface 
IEntity 
< 
T 
> 
{ 
public		 
T		 
Id		 
{		 
get		 
;		 
set		 
;		 
}		  !
} 
} Ç
RC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\MedicalFile.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
MedicalFile 
: 
IEntity &
<& '
Guid' +
>+ ,
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
[ 	

JsonIgnore	 
] 
public 
Patient 
Patient 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	

JsonIgnore	 
] 
public 
Guid 
? 
	PatientId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
IList 
< 
Medicine 
> 
Medicine '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
new8 ;
List< @
<@ A
MedicineA I
>I J
(J K
)K L
;L M
public 
IList 
< 
	Diagnosis 
> 
	Diagnosis  )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
List> B
<B C
	DiagnosisC L
>L M
(M N
)N O
;O P
} 
} Î
OC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\Medicine.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
Medicine 
: 
IEntity #
<# $
Guid$ (
>( )
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 
string 
MedicineName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Dosage 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Guid 
? 
MedicalFileID "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} °
NC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\Patient.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public		 

class		 
Patient		 
:		 
User		 
{

 
public 
Doctor 
Doctor 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Guid 
? 
DoctorId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
MedicalFile 
MedicalFile &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ‰	
KC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Models\User.cs
	namespace 	
DataAccessLayer
 
. 
Models  
{ 
public 

class 
User 
: 
IdentityUser $
<$ %
Guid% )
>) *
,* +
IEntity, 3
<3 4
Guid4 8
>8 9
{ 
public		 
string		 
	FirstName		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 
LastName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
RefreshToken "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
DateOfBirth #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
override 
Guid 
Id 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} è
bC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\AppointmentRepository.cs
	namespace

 	
DataAccessLayer


 
.

 
Repositories

 &
{ 
public 

class !
AppointmentRepository &
:' (
BaseRepository) 7
<7 8
Appointment8 C
,C D
GuidE I
>I J
,J K"
IAppointmentRepositoryL b
{ 
public !
AppointmentRepository $
($ %
AppDbContext% 1
context2 9
)9 :
:; <
base= A
(A B
contextB I
)I J
{ 	
} 	
public 
List 
< 
Appointment 
>  #
GetAppointmentsByUserID! 8
(8 9
Guid9 =
userID> D
)D E
{ 	
var 
appointments 
= 
_context '
.' (
Appointments( 4
.4 5
Include5 <
(< =
d= >
=>? A
dB C
.C D
DoctorD J
)J K
.K L
WhereL Q
(Q R
xR S
=>T V
xW X
.X Y
	PatientIdY b
==c e
userIDf l
||m o
xp q
.q r
DoctorIdr z
=={ }
userID	~ Ñ
)
Ñ Ö
;
Ö Ü
return 
appointments 
.  
ToList  &
(& '
)' (
;( )
} 	
} 
} ó%
[C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\BaseRepository.cs
	namespace		 	
DataAccessLayer		
 
.		 
Repositories		 &
{

 
public 

class 
BaseRepository 
<  
T  !
,! "
TPrimaryKey# .
>. /
:0 1
IBaseRepository2 A
<A B
TB C
,C D
TPrimaryKeyE P
>P Q
whereR W
TX Y
:Z [
class\ a
,a b
IEntityc j
<j k
TPrimaryKeyk v
>v w
{ 
	protected 
readonly 
AppDbContext '
_context( 0
;0 1
private 
DbSet 
< 
T 
> 
	_entities "
;" #
public 
BaseRepository 
( 
AppDbContext *
context+ 2
)2 3
{ 	
_context 
= 
context 
; 
	_entities 
= 
context 
.  
Set  #
<# $
T$ %
>% &
(& '
)' (
;( )
} 	
public 
bool 
Delete 
( 
TPrimaryKey &
id' )
)) *
{ 	
if 
( 
id 
== 
null 
) 
throw !
new" %!
ArgumentNullException& ;
(; <
$str< D
)D E
;E F
T 
entity 
= 
	_entities  
.  !
SingleOrDefault! 0
(0 1
s1 2
=>3 5
Equals6 <
(< =
s= >
.> ?
Id? A
,A B
idC E
)E F
)F G
;G H
if 
( 
entity 
== 
null 
) 
{ 
return 
false 
; 
} 
	_entities 
. 
Remove 
( 
entity #
)# $
;$ %
_context 
. 
SaveChanges  
(  !
)! "
;" #
return 
true 
; 
}   	
public"" 
async"" 
Task"" 
<"" 
IEnumerable"" %
<""% &
T""& '
>""' (
>""( )
GetAll""* 0
(""0 1
)""1 2
{## 	
return$$ 
await$$ 
	_entities$$ "
.$$" #
ToListAsync$$# .
($$. /
)$$/ 0
;$$0 1
}%% 	
public'' 
async'' 
Task'' 
<'' 
T'' 
>'' 
GetById'' $
(''$ %
TPrimaryKey''% 0
id''1 3
)''3 4
{(( 	
return)) 
await)) 
	_entities)) "
.))" # 
SingleOrDefaultAsync))# 7
())7 8
s))8 9
=>)): <
Equals))= C
())C D
s))D E
.))E F
Id))F H
,))H I
id))J L
)))L M
)))M N
;))N O
}** 	
public,, 
async,, 
Task,, 
<,, 
int,, 
>,, 
Insert,, %
(,,% &
T,,& '
entity,,( .
),,. /
{-- 	
if.. 
(.. 
entity.. 
==.. 
null.. 
).. 
throw..  %
new..& )!
ArgumentNullException..* ?
(..? @
$str..@ H
)..H I
;..I J
	_entities00 
.00 
Add00 
(00 
entity00  
)00  !
;00! "
return11 
await11 
_context11 !
.11! "
SaveChangesAsync11" 2
(112 3
)113 4
;114 5
}22 	
public44 
void44 
Update44 
(44 
T44 
entity44 #
)44# $
{55 	
if66 
(66 
entity66 
==66 
null66 
)66 
throw66  %
new66& )!
ArgumentNullException66* ?
(66? @
$str66@ H
)66H I
;66I J
	_entities77 
.77 
Update77 
(77 
entity77 #
)77# $
;77$ %
_context88 
.88 
SaveChanges88  
(88  !
)88! "
;88" #
}99 	
}:: 
};; ‘
]C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\DoctorRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

class		 
DoctorRepository		 !
:		" #
BaseRepository		$ 2
<		2 3
Doctor		3 9
,		9 :
Guid		; ?
>		? @
,		@ A
IDoctorRepository		B S
{

 
public 
DoctorRepository 
(  
AppDbContext  ,
context- 4
)4 5
:6 7
base8 <
(< =
context= D
)D E
{ 	
} 	
} 
} å
cC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IAppointmentRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

	interface		 "
IAppointmentRepository		 +
:		, -
IBaseRepository		. =
<		= >
Appointment		> I
,		I J
Guid		K O
>		O P
{

 
List 
< 
Appointment 
> #
GetAppointmentsByUserID 1
(1 2
Guid2 6
userID7 =
)= >
;> ?
} 
} É

\C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IBaseRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

	interface		 
IBaseRepository		 $
<		$ %
T		% &
,		& '
TPrimaryKey		( 3
>		3 4
where		5 :
T		; <
:		< =
IEntity		> E
<		E F
TPrimaryKey		F Q
>		Q R
{

 
Task 
< 
IEnumerable 
< 
T 
> 
> 
GetAll #
(# $
)$ %
;% &
Task 
< 
T 
> 
GetById 
( 
TPrimaryKey #
id$ &
)& '
;' (
Task 
< 
int 
> 
Insert 
( 
T 
entity !
)! "
;" #
void 
Update 
( 
T 
entity 
) 
; 
bool 
Delete 
( 
TPrimaryKey 
id  "
)" #
;# $
} 
} º
^C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IDoctorRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public 

	interface 
IDoctorRepository &
:' (
IBaseRepository) 8
<8 9
Doctor9 ?
,? @
GuidA E
>E F
{		 
}

 
} ú	
cC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IMedicalFileRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

	interface		 "
IMedicalFileRepository		 +
:		, -
IBaseRepository		. =
<		= >
MedicalFile		> I
,		I J
Guid		K O
>		O P
{

 
Task 
< 
MedicalFile 
> $
addMedicineToMedicalFile 2
(2 3
Guid3 7
medicalFileID8 E
,E F
MedicineG O
medicineP X
)X Y
;Y Z
Task 
< 
MedicalFile 
> %
addDiagnosisToMedicalFile 3
(3 4
Guid4 8
medicalFileID9 F
,F G
	DiagnosisH Q
	diagnosisR [
)[ \
;\ ]
Task 
< 
MedicalFile 
> %
getMedicalFileByPatientId 3
(3 4
Guid4 8
	patientId9 B
)B C
;C D
} 
} ¬
`C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IMedicineRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public 

	interface 
IMedicineRepository (
:) *
IBaseRepository+ :
<: ;
Medicine; C
,C D
GuidE I
>I J
{		 
}

 
} ø
_C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IPatientRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

	interface		 
IPatientRepository		 '
:		( )
IBaseRepository		* 9
<		9 :
Patient		: A
,		A B
Guid		C G
>		G H
{

 
} 
} Í
\C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\IUserRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public		 

	interface		 
IUserRepository		 $
:		% &
IBaseRepository		' 6
<		6 7
User		7 ;
,		; <
Guid		= A
>		A B
{

 
Task 
< 
User 
> 
GetByUsername  
(  !
string! '
username( 0
)0 1
;1 2
} 
} àJ
bC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\MedicalFileRepository.cs
	namespace		 	
DataAccessLayer		
 
.		 
Repositories		 &
{

 
public 

class !
MedicalFileRepository &
:' (
BaseRepository) 7
<7 8
MedicalFile8 C
,C D
GuidE I
>I J
,J K"
IMedicalFileRepositoryL b
{ 
private 
readonly 
IPatientRepository +
_patientRepository, >
;> ?
public !
MedicalFileRepository $
($ %
AppDbContext% 1
context2 9
,9 :
IPatientRepository; M
patientRepositoryN _
)_ `
:a b
basec g
(g h
contexth o
)o p
{ 	
_patientRepository 
=  
patientRepository! 2
;2 3
} 	
public 
async 
Task 
< 
MedicalFile %
>% &%
addDiagnosisToMedicalFile' @
(@ A
GuidA E
medicalFileIDF S
,S T
	DiagnosisU ^
	diagnosis_ h
)h i
{ 	
var 
medicalFile 
= 
await #
_context$ ,
., -
MedicalFiles- 9
.9 : 
SingleOrDefaultAsync: N
(N O
xO P
=>Q S
xT U
.U V
	PatientIdV _
==` b
medicalFileIDc p
)p q
;q r
if 
( 
medicalFile 
== 
null "
)" #
{ 
var 
patient 
= 
await #
_patientRepository$ 6
.6 7
GetById7 >
(> ?
medicalFileID? L
)L M
;M N
MedicalFile 
file  
=! "
new# &
MedicalFile' 2
(2 3
)3 4
;4 5
file 
. 
Patient 
= 
patient &
;& '
await 
Insert 
( 
file !
)! "
;" #
var 
medicalFile2  
=! "
await# (
_context) 1
.1 2
MedicalFiles2 >
.> ? 
SingleOrDefaultAsync? S
(S T
xT U
=>V X
xY Z
.Z [
	PatientId[ d
==e g
medicalFileIDh u
)u v
;v w
medicalFile2 
. 
	Diagnosis &
.& '
Add' *
(* +
	diagnosis+ 4
)4 5
;5 6
var 
result1 
= 
await #
_context$ ,
., -
SaveChangesAsync- =
(= >
)> ?
;? @
if!! 
(!! 
result1!! 
>!! 
$num!! 
)!!  
{"" 
return## 
medicalFile2## '
;##' (
}$$ 
return&& 
null&& 
;&& 
}'' 
medicalFile)) 
.)) 
	Diagnosis)) !
.))! "
Add))" %
())% &
	diagnosis))& /
)))/ 0
;))0 1
var** 
result2** 
=** 
await** 
_context**  (
.**( )
SaveChangesAsync**) 9
(**9 :
)**: ;
;**; <
if,, 
(,, 
result2,, 
>,, 
$num,, 
),, 
{-- 
return.. 
medicalFile.. "
;.." #
}// 
return11 
null11 
;11 
}22 	
public44 
async44 
Task44 
<44 
MedicalFile44 %
>44% &$
addMedicineToMedicalFile44' ?
(44? @
Guid44@ D
medicalFileID44E R
,44R S
Medicine44T \
medicine44] e
)44e f
{55 	
var66 
medicalFile66 
=66 
await66 #
_context66$ ,
.66, -
MedicalFiles66- 9
.669 : 
SingleOrDefaultAsync66: N
(66N O
x66O P
=>66Q S
x66T U
.66U V
	PatientId66V _
==66` b
medicalFileID66c p
)66p q
;66q r
if77 
(77 
medicalFile77 
==77 
null77 #
)77# $
{88 
var99 
patient99 
=99 
await99 #
_patientRepository99$ 6
.996 7
GetById997 >
(99> ?
medicalFileID99? L
)99L M
;99M N
MedicalFile:: 
file::  
=::! "
new::# &
MedicalFile::' 2
(::2 3
)::3 4
;::4 5
file;; 
.;; 
Patient;; 
=;; 
patient;; &
;;;& '
await<< 
Insert<< 
(<< 
file<< !
)<<! "
;<<" #
var== 
medicalFile2==  
===! "
await==# (
_context==) 1
.==1 2
MedicalFiles==2 >
.==> ? 
SingleOrDefaultAsync==? S
(==S T
x==T U
=>==V X
x==Y Z
.==Z [
	PatientId==[ d
====e g
medicalFileID==h u
)==u v
;==v w
medicalFile2>> 
.>> 
Medicine>> %
.>>% &
Add>>& )
(>>) *
medicine>>* 2
)>>2 3
;>>3 4
var?? 
result1?? 
=?? 
await?? #
_context??$ ,
.??, -
SaveChangesAsync??- =
(??= >
)??> ?
;??? @
ifAA 
(AA 
result1AA 
>AA 
$numAA 
)AA  
{BB 
returnCC 
medicalFile2CC '
;CC' (
}DD 
returnFF 
nullFF 
;FF 
}GG 
medicalFileHH 
.HH 
MedicineHH  
.HH  !
AddHH! $
(HH$ %
medicineHH% -
)HH- .
;HH. /
varII 
resultII 
=II 
awaitII 
_contextII '
.II' (
SaveChangesAsyncII( 8
(II8 9
)II9 :
;II: ;
ifJJ 
(JJ 
resultJJ 
>JJ 
$numJJ 
)JJ 
{KK 
returnLL 
medicalFileLL "
;LL" #
}MM 
returnNN 
nullNN 
;NN 
}OO 	
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
MedicalFileQQ %
>QQ% &%
getMedicalFileByPatientIdQQ' @
(QQ@ A
GuidQQA E
	patientIdQQF O
)QQO P
{RR 	
varSS 
patientSS 
=SS 
awaitSS 
_patientRepositorySS  2
.SS2 3
GetByIdSS3 :
(SS: ;
	patientIdSS; D
)SSD E
;SSE F
ConsoleTT 
.TT 
	WriteLineTT 
(TT 
patientTT %
.TT% &
	FirstNameTT& /
)TT/ 0
;TT0 1
ifUU 
(UU 
patientUU 
==UU 
nullUU 
)UU 
{VV 
returnWW 
nullWW 
;WW 
}XX 
varYY 
medicalFileResultYY !
=YY" #
awaitYY$ )
_contextYY* 2
.YY2 3
MedicalFilesYY3 ?
.YY? @
IncludeYY@ G
(YYG H
mYYH I
=>YYJ L
mYYM N
.YYN O
MedicineYYO W
)YYW X
.YYX Y
IncludeYYY `
(YY` a
mYYa b
=>YYc e
mYYf g
.YYg h
	DiagnosisYYh q
)YYq r
.YYr s!
SingleOrDefaultAsync	YYs á
(
YYá à
x
YYà â
=>
YYä å
x
YYç é
.
YYé è
	PatientId
YYè ò
==
YYô õ
	patientId
YYú •
)
YY• ¶
;
YY¶ ß
ifZZ 
(ZZ 
medicalFileResultZZ  
==ZZ! #
nullZZ$ (
)ZZ( )
{[[ 
MedicalFile]] 
file]]  
=]]! "
new]]# &
MedicalFile]]' 2
(]]2 3
)]]3 4
;]]4 5
file^^ 
.^^ 
Patient^^ 
=^^ 
patient^^ &
;^^& '
await__ 
Insert__ 
(__ 
file__ !
)__! "
;__" #
}`` 
returnaa 
awaitaa 
_contextaa !
.aa! "
MedicalFilesaa" .
.aa. /
Includeaa/ 6
(aa6 7
maa7 8
=>aa9 ;
maa< =
.aa= >
Medicineaa> F
)aaF G
.aaG H
IncludeaaH O
(aaO P
maaP Q
=>aaR T
maaU V
.aaV W
	DiagnosisaaW `
)aa` a
.aaa b 
SingleOrDefaultAsyncaab v
(aav w
xaaw x
=>aay {
xaa| }
.aa} ~
	PatientId	aa~ á
==
aaà ä
	patientId
aaã î
)
aaî ï
;
aaï ñ
}bb 	
}cc 
}dd ª
_C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\MedicineRepository.cs
	namespace 	
DataAccessLayer
 
. 
Repositories &
{ 
public 

class 
MedicineRepository #
{ 
}		 
}

 Ÿ
^C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\PatientRepository.cs
	namespace		 	
DataAccessLayer		
 
.		 
Repositories		 &
{

 
public 

class 
PatientRepository "
:# $
BaseRepository% 3
<3 4
Patient4 ;
,; <
Guid= A
>A B
,B C
IPatientRepositoryD V
{ 
public 
PatientRepository  
(  !
AppDbContext! -
context. 5
)5 6
:7 8
base9 =
(= >
context> E
)E F
{ 	
} 	
} 
} Í	
[C:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Repositories\UserRepository.cs
	namespace

 	
DataAccessLayer


 
.

 
Repositories

 &
{ 
public 

class 
UserRepository 
:  !
BaseRepository" 0
<0 1
User1 5
,5 6
Guid7 ;
>; <
,< =
IUserRepository> M
{ 
public 
UserRepository 
( 
AppDbContext *
context+ 2
)2 3
:4 5
base6 :
(: ;
context; B
)B C
{ 	
} 	
public 
async 
Task 
< 
User 
> 
GetByUsername  -
(- .
string. 4
username5 =
)= >
{ 	
return 
await 
_context !
.! "
Users" '
.' ( 
SingleOrDefaultAsync( <
(< =
x= >
=>? A
xB C
.C D
UserNameD L
==M O
usernameP X
)X Y
;Y Z
} 	
} 
} î
ZC:\Users\Danny\source\repos\DocPatientAPINew\DataAccessLayer\Startup\DependencySetupDAL.cs
	namespace 	
DataAccessLayer
 
. 
Startup !
{ 
public 

class 
DependencySetupDAL #
{ 
public 
static 
void 
ConfigureServices ,
(, -
IServiceCollection- ?
services@ H
,H I
IConfigurationJ X
configurationY f
)f g
{ 	
services 
. 
AddDbContext !
<! "
AppDbContext" .
>. /
(/ 0
options0 7
=>8 :
options; B
.B C
UseSqlServerC O
(O P
configurationP ]
.] ^
GetConnectionString^ q
(q r
$strr |
)| }
)} ~
)~ 
;	 Ä
services 
. 
	AddScoped 
< 
IUserRepository .
,. /
UserRepository0 >
>> ?
(? @
)@ A
;A B
services 
. 
	AddScoped 
< "
IMedicalFileRepository 5
,5 6!
MedicalFileRepository7 L
>L M
(M N
)N O
;O P
services 
. 
	AddScoped 
< 
IPatientRepository 1
,1 2
PatientRepository3 D
>D E
(E F
)F G
;G H
services 
. 
	AddScoped 
< "
IAppointmentRepository 5
,5 6!
AppointmentRepository7 L
>L M
(M N
)N O
;O P
services 
. 
	AddScoped 
< 
IDoctorRepository 0
,0 1
DoctorRepository2 B
>B C
(C D
)D E
;E F
} 	
} 
}   